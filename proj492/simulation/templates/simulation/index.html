<!DOCTYPE html>
<html lang="en">



{# Load the tag library #}
{% load bootstrap5 %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}



{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'simulation/index.css' %}">
<script src='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v3.0.11/turf.min.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet' />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>


<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proj492</title>

    <div class="row nav" style="width:1757px;display:flex;padding:10px">
        <div class='col-1'>
            <h2>Simulation</h2>
        </div>
        <div class='col-3'>
            <button type="button" class="btn btn-primary" id="addShip">Add Ship</button>
            <button type="button" class="btn btn-primary" id="pause">Pause</button>
            <button type="button" class="btn btn-primary" id="start">Start</button>
            <button type="button" class="btn btn-primary" id="reset">Reset</button>
        </div>
        <div class='col-4' style="display: flex;">
            <h3 id="coord1" style="margin-right: 40px;">0.0</h3>
            <h3 id="coord2">0.0</h3>
            <input type="text" id="shipName">

        </div>
    </div>

    <div class="container mainBody">
        <div class="row map1" id='map' style="width:1757px;height:600px;">
        </div>
        <div class="row" style="display:flex;justify-content: center; width:1757px;height:209px; ">
            <div class="col display">
                <h2>Display1</h2>
            </div>
            <div class="col display">
                <h2>Display2</h2>
            </div>
            <div class="col display">
                <h2>Display3</h2>
            </div>

        </div>



    </div>

</head>

<body>

</body>

</html>




<script>
    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    mapboxgl.accessToken =
        'pk.eyJ1Ijoib25kZXJwZWhsaXZhbiIsImEiOiJja3dmY3M4bzUwZGhjMndydXg5MjNtbDczIn0.IUrPfId24D71j_cwM_9PdQ';


    const map = new mapboxgl.Map({

        container: 'map', // container ID
        style: 'mapbox://styles/onderpehlivan/ckwp96xek2h2214t5xfyjxcce', // style URL
        center: [-94.88, 29.62], // starting position [lng, lat]
        zoom: 9, // starting zoom
        fadeDuration: 3000
    })

    var coordinateCounter = 1
    map.on('click', function (e) {
        console.log(e.lngLat)
        if (coordinateCounter % 2 == 1) {
            const text1 = `${e.lngLat["lat"]},${e.lngLat["lng"]},`
            $("#coord1").text(text1)
        }
        else {
            const text2 = `${e.lngLat["lat"]},${e.lngLat["lng"]},`
            $("#coord2").text(text2)
        }
        coordinateCounter += 1
    });





    map.on('load', () => {
        // // Add an image to use as a custom marker
        map.addSource('topLeft', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                    {
                        // feature for Mapbox SF
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [-94.98276875969165, 29.60664638126832]
                        },
                        'properties': {
                            'title': '*'
                        }
                    }
                ]
            }
        });

        map.addLayer({
            'id': 'topLeft',
            'type': 'symbol',
            'source': 'topLeft',
            'layout': {
                'icon-image': 'custom-marker',
                // get the title name from the source's "title" property
                'text-field': ['get', 'title'],
                'text-font': [
                    'Open Sans Semibold',
                    'Arial Unicode MS Bold'
                ],
                'text-offset': [0, 0],
                'text-anchor': 'top'
            }
        });


        map.addSource('topRight', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                    {
                        // feature for Mapbox SF
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [-94.70797854725448, 29.601567347418523]
                        },
                        'properties': {
                            'title': '*'
                        }
                    }
                ]
            }
        });

        map.addLayer({
            'id': 'topRight',
            'type': 'symbol',
            'source': 'topRight',
            'layout': {
                'icon-image': 'custom-marker',
                // get the title name from the source's "title" property
                'text-field': ['get', 'title'],
                'text-font': [
                    'Open Sans Semibold',
                    'Arial Unicode MS Bold'
                ],
                'text-offset': [0, 0],
                'text-anchor': 'top'
            }
        });


        map.addSource('bottomLeft', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                    {
                        // feature for Mapbox SF
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [-95.03756305694266, 29.379566938728473]
                        },
                        'properties': {
                            'title': '*'
                        }
                    }
                ]
            }
        });

        map.addLayer({
            'id': 'bottomLeft',
            'type': 'symbol',
            'source': 'bottomLeft',
            'layout': {
                'icon-image': 'custom-marker',
                // get the title name from the source's "title" property
                'text-field': ['get', 'title'],
                'text-font': [
                    'Open Sans Semibold',
                    'Arial Unicode MS Bold'
                ],
                'text-offset': [0, 0],
                'text-anchor': 'top'
            }
        });



        map.addSource('bottomRight', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                    {
                        // feature for Mapbox SF
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [-94.70797854725448, 29.601567347418523]
                        },
                        'properties': {
                            'title': '*'
                        }
                    }
                ]
            }
        });

        map.addLayer({
            'id': 'bottomRight',
            'type': 'symbol',
            'source': 'bottomRight',
            'layout': {
                'icon-image': 'custom-marker',
                // get the title name from the source's "title" property
                'text-field': ['get', 'title'],
                'text-font': [
                    'Open Sans Semibold',
                    'Arial Unicode MS Bold'
                ],
                'text-offset': [0, 0],
                'text-anchor': 'top'
            }
        });


        map.addSource('ship1', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                    {
                        // feature for Mapbox SF
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [-95.03749367982192, 29.397919986593962]
                        },
                        'properties': {
                            'title': '--'
                        }
                    }
                ]
            }
        });

        map.addLayer({
            'id': 'ship1',
            'type': 'symbol',
            'source': 'ship1',
            'layout': {
                'icon-image': 'custom-marker',
                'text-field': ['get', 'title'],
                'text-font': [
                    'Open Sans Semibold',
                    'Arial Unicode MS Bold'
                ],
                'text-offset': [0, 0],
                'text-anchor': 'top'
            }
        });

        map.addSource('ship2', {
            'type': 'geojson',
            'data': {
                'type': 'FeatureCollection',
                'features': [
                    {
                        // feature for Mapbox SF
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [-95.03749367982192, 29.397919986593962]
                        },
                        'properties': {
                            'title': '--'
                        }
                    }
                ]
            }
        });

        map.addLayer({
            'id': 'ship2',
            'type': 'symbol',
            'source': 'ship2',
            'layout': {
                'icon-image': 'custom-marker',
                'text-field': ['get', 'title'],
                'text-font': [
                    'Open Sans Semibold',
                    'Arial Unicode MS Bold'
                ],
                'text-offset': [0, 0],
                'text-anchor': 'top'
            }
        });







        // let latitute = map.getSource('points')._options.data["features"][0]["geometry"]["coordinates"][1]
        // let longitude = map.getSource('points')._options.data["features"][0]["geometry"]["coordinates"][0]



        map.loadImage("{% static 'images/shipl.png' %}", (error, image) => {
            if (error) throw error;
            map.addImage('shipl', image);

        });

        map.loadImage("{% static 'images/shipr.png' %}", (error, image) => {
            if (error) throw error;

            map.addImage('shipr', image);

        });


        var origin3 = [-94.7652154047894, 29.356139296237075];


        const coordinates = [[-94.97107555916241, 29.59644500826481], [-94.97107555916241, 29.595424870964457], [-94.97107555916241, 29.594404733664106], [-94.97107555916241, 29.593384596363755], [-94.97107555916241, 29.592364459063404], [-94.97107555916241, 29.591344321763053], [-94.97107555916241, 29.590324184462702], [-94.97107555916241, 29.58930404716235], [-94.97107555916241, 29.588283909862], [-94.97107555916241, 29.58726377256165], [-94.97107555916241, 29.586243635261294], [-94.97107555916241, 29.585223497960943], [-94.97107555916241, 29.58420336066059], [-94.97107555916241, 29.58318322336024], [-94.97107555916241, 29.58216308605989], [-94.97107555916241, 29.58114294875954], [-94.97107555916241, 29.580122811459187], [-94.97107555916241, 29.579102674158836], [-94.97107555916241, 29.578082536858485], [-94.97107555916241, 29.577062399558134], [-94.97107555916241, 29.576042262257783], [-94.97107555916241, 29.57502212495743], [-94.97107555916241, 29.57400198765708], [-94.97107555916241, 29.57298185035673], [-94.97107555916241, 29.57196171305638], [-94.97107555916241, 29.570941575756027], [-94.97107555916241, 29.569921438455676], [-94.97107555916241, 29.568901301155325], [-94.97107555916241, 29.567881163854974], [-94.97107555916241, 29.566861026554623], [-94.97107555916241, 29.56584088925427], [-94.97107555916241, 29.56482075195392], [-94.97107555916241, 29.56380061465357], [-94.97107555916241, 29.56278047735322], [-94.97107555916241, 29.561760340052867], [-94.97107555916241, 29.560740202752516], [-94.97107555916241, 29.559720065452165], [-94.97107555916241, 29.558699928151814], [-94.97107555916241, 29.557679790851463], [-94.97107555916241, 29.55665965355111], [-94.97107555916241, 29.55563951625076], [-94.97107555916241, 29.55461937895041], [-94.97107555916241, 29.55359924165006], [-94.97107555916241, 29.552579104349707], [-94.97107555916241, 29.551558967049356], [-94.97107555916241, 29.550538829749005], [-94.97107555916241, 29.549518692448654], [-94.97107555916241, 29.548498555148303], [-94.97107555916241, 29.54747841784795], [-94.97107555916241, 29.546458280547597], [-94.97107555916241, 29.545438143247246], [-94.97107555916241, 29.544418005946895], [-94.97107555916241, 29.543397868646544], [-94.97107555916241, 29.542377731346193], [-94.97107555916241, 29.54135759404584], [-94.97107555916241, 29.54033745674549], [-94.97107555916241, 29.53931731944514], [-94.97107555916241, 29.538297182144788], [-94.97107555916241, 29.537277044844437], [-94.97107555916241, 29.536256907544086], [-94.97107555916241, 29.535236770243735], [-94.97107555916241, 29.534216632943384], [-94.97107555916241, 29.533196495643033], [-94.97107555916241, 29.53217635834268], [-94.97107555916241, 29.53115622104233], [-94.97107555916241, 29.53013608374198], [-94.97107555916241, 29.529115946441628], [-94.97107555916241, 29.528095809141277], [-94.97107555916241, 29.527075671840926], [-94.97107555916241, 29.526055534540575], [-94.97107555916241, 29.525035397240224], [-94.97107555916241, 29.524015259939873], [-94.97107555916241, 29.52299512263952], [-94.97107555916241, 29.52197498533917], [-94.97107555916241, 29.52095484803882], [-94.97107555916241, 29.519934710738468], [-94.97107555916241, 29.518914573438117], [-94.97107555916241, 29.517894436137766], [-94.97107555916241, 29.516874298837415], [-94.97107555916241, 29.515854161537064], [-94.96990623910949, 29.515854161537064], [-94.96873691905657, 29.515854161537064], [-94.96873691905657, 29.514834024236713], [-94.96756759900364, 29.514834024236713], [-94.96639827895072, 29.514834024236713], [-94.9652289588978, 29.514834024236713], [-94.9652289588978, 29.51381388693636], [-94.96405963884487, 29.51381388693636], [-94.96289031879195, 29.51381388693636], [-94.96172099873901, 29.51381388693636], [-94.96172099873901, 29.51279374963601], [-94.96055167868609, 29.51279374963601], [-94.95938235863316, 29.51279374963601], [-94.95821303858024, 29.51279374963601], [-94.95821303858024, 29.51177361233566], [-94.95704371852732, 29.51177361233566], [-94.95587439847439, 29.51177361233566], [-94.95470507842147, 29.51177361233566], [-94.95353575836855, 29.51177361233566], [-94.95236643831562, 29.51177361233566], [-94.95236643831562, 29.510753475035308], [-94.9511971182627, 29.510753475035308], [-94.95002779820977, 29.510753475035308], [-94.94885847815685, 29.510753475035308], [-94.94885847815685, 29.509733337734957], [-94.94768915810393, 29.509733337734957], [-94.946519838051, 29.509733337734957], [-94.94535051799808, 29.509733337734957], [-94.94535051799808, 29.508713200434606], [-94.94418119794516, 29.508713200434606], [-94.94301187789223, 29.508713200434606], [-94.94184255783931, 29.508713200434606], [-94.94184255783931, 29.507693063134255], [-94.94067323778638, 29.507693063134255], [-94.93950391773346, 29.507693063134255], [-94.93833459768054, 29.507693063134255], [-94.93716527762761, 29.507693063134255], [-94.93716527762761, 29.506672925833904], [-94.93599595757469, 29.506672925833904], [-94.93482663752177, 29.506672925833904], [-94.93365731746884, 29.506672925833904], [-94.93365731746884, 29.50565278853355], [-94.93248799741592, 29.50565278853355], [-94.931318677363, 29.50565278853355], [-94.93014935731007, 29.50565278853355], [-94.92898003725715, 29.50565278853355], [-94.92781071720422, 29.50565278853355], [-94.92781071720422, 29.504632651233198], [-94.9266413971513, 29.504632651233198], [-94.92547207709838, 29.504632651233198], [-94.92430275704545, 29.504632651233198], [-94.92313343699253, 29.504632651233198], [-94.92313343699253, 29.503612513932847], [-94.9219641169396, 29.503612513932847], [-94.92079479688667, 29.503612513932847], [-94.91962547683374, 29.503612513932847], [-94.91962547683374, 29.502592376632496], [-94.91845615678082, 29.502592376632496], [-94.9172868367279, 29.502592376632496], [-94.91611751667497, 29.502592376632496], [-94.91494819662205, 29.502592376632496], [-94.91377887656913, 29.502592376632496], [-94.9126095565162, 29.502592376632496], [-94.91144023646328, 29.502592376632496], [-94.91027091641035, 29.502592376632496], [-94.90910159635743, 29.502592376632496], [-94.90910159635743, 29.501572239332145], [-94.90910159635743, 29.500552102031794], [-94.90910159635743, 29.499531964731442], [-94.90910159635743, 29.49851182743109], [-94.90910159635743, 29.49749169013074], [-94.90910159635743, 29.49647155283039], [-94.90910159635743, 29.495451415530038], [-94.90910159635743, 29.494431278229687], [-94.90910159635743, 29.493411140929336], [-94.90910159635743, 29.492391003628985], [-94.90910159635743, 29.491370866328634], [-94.90910159635743, 29.490350729028282], [-94.90910159635743, 29.48933059172793], [-94.90910159635743, 29.48831045442758], [-94.90910159635743, 29.48729031712723], [-94.90910159635743, 29.486270179826878], [-94.90910159635743, 29.485250042526527], [-94.90910159635743, 29.484229905226176], [-94.90910159635743, 29.483209767925825], [-94.90910159635743, 29.482189630625474], [-94.90910159635743, 29.481169493325122], [-94.90910159635743, 29.48014935602477], [-94.90910159635743, 29.47912921872442], [-94.90910159635743, 29.47810908142407], [-94.90910159635743, 29.477088944123718], [-94.90910159635743, 29.476068806823367], [-94.90910159635743, 29.475048669523016], [-94.90910159635743, 29.474028532222665], [-94.90910159635743, 29.473008394922314], [-94.90910159635743, 29.471988257621963], [-94.90910159635743, 29.47096812032161], [-94.90910159635743, 29.46994798302126], [-94.90910159635743, 29.46892784572091], [-94.90910159635743, 29.467907708420558], [-94.90910159635743, 29.466887571120207], [-94.90910159635743, 29.465867433819852], [-94.90910159635743, 29.4648472965195], [-94.90910159635743, 29.46382715921915], [-94.90910159635743, 29.4628070219188], [-94.90910159635743, 29.461786884618448], [-94.90910159635743, 29.460766747318097], [-94.90910159635743, 29.459746610017746], [-94.90910159635743, 29.458726472717395], [-94.90910159635743, 29.457706335417043], [-94.90910159635743, 29.456686198116692], [-94.90910159635743, 29.45566606081634], [-94.90910159635743, 29.45464592351599], [-94.90910159635743, 29.45362578621564], [-94.90910159635743, 29.452605648915288], [-94.90910159635743, 29.451585511614937], [-94.90910159635743, 29.450565374314586], [-94.90910159635743, 29.449545237014235], [-94.90910159635743, 29.448525099713883], [-94.90910159635743, 29.447504962413532], [-94.90910159635743, 29.44648482511318], [-94.90910159635743, 29.44546468781283], [-94.9079322763045, 29.44546468781283], [-94.90676295625158, 29.44546468781283], [-94.90559363619866, 29.44546468781283], [-94.90442431614574, 29.44546468781283], [-94.90325499609281, 29.44546468781283], [-94.90208567603989, 29.44546468781283], [-94.90091635598696, 29.44546468781283], [-94.89974703593404, 29.44546468781283], [-94.89857771588112, 29.44546468781283], [-94.8974083958282, 29.44546468781283], [-94.89623907577527, 29.44546468781283], [-94.89506975572235, 29.44546468781283], [-94.89390043566942, 29.44546468781283], [-94.8927311156165, 29.44546468781283], [-94.89156179556358, 29.44546468781283], [-94.89039247551065, 29.44546468781283], [-94.88922315545773, 29.44546468781283], [-94.8880538354048, 29.44546468781283], [-94.88688451535188, 29.44546468781283], [-94.88571519529896, 29.44546468781283], [-94.88454587524603, 29.44546468781283], [-94.88337655519311, 29.44546468781283], [-94.88220723514019, 29.44546468781283], [-94.88103791508726, 29.44546468781283], [-94.87986859503432, 29.44546468781283], [-94.8786992749814, 29.44546468781283], [-94.87752995492848, 29.44546468781283], [-94.87636063487555, 29.44546468781283], [-94.87519131482263, 29.44546468781283], [-94.8740219947697, 29.44546468781283], [-94.87285267471678, 29.44546468781283], [-94.87168335466386, 29.44546468781283], [-94.87051403461093, 29.44546468781283], [-94.86934471455801, 29.44546468781283], [-94.86817539450509, 29.44546468781283], [-94.86700607445216, 29.44546468781283], [-94.86583675439924, 29.44546468781283], [-94.86466743434632, 29.44546468781283], [-94.86349811429339, 29.44546468781283], [-94.86232879424047, 29.44546468781283], [-94.86115947418755, 29.44546468781283], [-94.85999015413462, 29.44546468781283], [-94.8588208340817, 29.44546468781283], [-94.85765151402877, 29.44546468781283], [-94.85648219397585, 29.44546468781283], [-94.85531287392293, 29.44546468781283], [-94.85414355387, 29.44546468781283], [-94.85297423381708, 29.44546468781283], [-94.85180491376416, 29.44546468781283], [-94.85063559371123, 29.44546468781283], [-94.84946627365831, 29.44546468781283], [-94.84829695360538, 29.44546468781283], [-94.84712763355246, 29.44546468781283], [-94.84595831349954, 29.44546468781283], [-94.84478899344661, 29.44546468781283], [-94.84361967339369, 29.44546468781283], [-94.84245035334077, 29.44546468781283], [-94.84128103328784, 29.44546468781283], [-94.84011171323492, 29.44546468781283], [-94.83894239318198, 29.44546468781283], [-94.83777307312906, 29.44546468781283], [-94.83660375307613, 29.44546468781283], [-94.83543443302321, 29.44546468781283], [-94.83426511297029, 29.44546468781283], [-94.83309579291736, 29.44546468781283], [-94.83192647286444, 29.44546468781283], [-94.83075715281151, 29.44546468781283], [-94.82958783275859, 29.44546468781283], [-94.82841851270567, 29.44546468781283], [-94.82724919265274, 29.44546468781283], [-94.82607987259982, 29.44546468781283], [-94.8249105525469, 29.44546468781283], [-94.82374123249397, 29.44546468781283], [-94.82257191244105, 29.44546468781283], [-94.82140259238813, 29.44546468781283], [-94.8202332723352, 29.44546468781283], [-94.81906395228228, 29.44546468781283], [-94.81789463222935, 29.44546468781283], [-94.81672531217643, 29.44546468781283], [-94.8155559921235, 29.44546468781283], [-94.81438667207058, 29.44546468781283], [-94.81321735201766, 29.44546468781283], [-94.81204803196474, 29.44546468781283], [-94.81087871191181, 29.44546468781283], [-94.80970939185889, 29.44546468781283], [-94.80854007180596, 29.44546468781283], [-94.80737075175304, 29.44546468781283], [-94.80620143170012, 29.44546468781283], [-94.8050321116472, 29.44546468781283], [-94.80386279159427, 29.44546468781283], [-94.80269347154135, 29.44546468781283], [-94.80152415148842, 29.44546468781283], [-94.8003548314355, 29.44546468781283], [-94.79918551138257, 29.44546468781283], [-94.79801619132964, 29.44546468781283], [-94.79684687127671, 29.44546468781283], [-94.79567755122379, 29.44546468781283], [-94.79450823117087, 29.44546468781283], [-94.79333891111794, 29.44546468781283], [-94.79216959106502, 29.44546468781283], [-94.7910002710121, 29.44546468781283], [-94.78983095095917, 29.44546468781283], [-94.78866163090625, 29.44546468781283], [-94.78749231085332, 29.44546468781283], [-94.7863229908004, 29.44546468781283], [-94.78515367074748, 29.44546468781283], [-94.78398435069455, 29.44546468781283], [-94.78281503064163, 29.44546468781283], [-94.7816457105887, 29.44546468781283], [-94.78047639053578, 29.44546468781283], [-94.77930707048286, 29.44546468781283], [-94.77813775042993, 29.44546468781283], [-94.77696843037701, 29.44546468781283], [-94.77579911032409, 29.44546468781283], [-94.77462979027116, 29.44546468781283], [-94.77346047021824, 29.44546468781283], [-94.77229115016532, 29.44546468781283], [-94.77112183011239, 29.44546468781283], [-94.76995251005947, 29.44546468781283], [-94.76878319000654, 29.44546468781283], [-94.76761386995362, 29.44546468781283], [-94.7664445499007, 29.44546468781283], [-94.76527522984777, 29.44546468781283], [-94.76410590979485, 29.44546468781283], [-94.76293658974193, 29.44546468781283], [-94.761767269689, 29.44546468781283], [-94.76059794963608, 29.44546468781283], [-94.75942862958316, 29.44546468781283], [-94.75825930953023, 29.44546468781283], [-94.7570899894773, 29.44546468781283], [-94.75592066942437, 29.44546468781283], [-94.75475134937145, 29.44546468781283], [-94.75358202931852, 29.44546468781283], [-94.7524127092656, 29.44546468781283], [-94.75124338921268, 29.44546468781283], [-94.75007406915975, 29.44546468781283], [-94.74890474910683, 29.44546468781283], [-94.7477354290539, 29.44546468781283], [-94.74656610900098, 29.44546468781283], [-94.74539678894806, 29.44546468781283], [-94.74422746889513, 29.44546468781283], [-94.74305814884221, 29.44546468781283], [-94.74188882878929, 29.44546468781283], [-94.74071950873636, 29.44546468781283], [-94.73955018868344, 29.44546468781283], [-94.73838086863051, 29.44546468781283], [-94.73721154857759, 29.44546468781283], [-94.73604222852467, 29.44546468781283], [-94.73487290847174, 29.44546468781283], [-94.73370358841882, 29.44546468781283], [-94.7325342683659, 29.44546468781283], [-94.73136494831297, 29.44546468781283], [-94.73019562826005, 29.44546468781283], [-94.72902630820712, 29.44546468781283], [-94.7278569881542, 29.44546468781283], [-94.72668766810128, 29.44546468781283], [-94.72551834804835, 29.44546468781283], [-94.72434902799543, 29.44546468781283], [-94.7231797079425, 29.44546468781283], [-94.72201038788958, 29.44546468781283], [-94.72084106783666, 29.44546468781283]]
        const coordinates2 = [[-94.75007406915975, 29.599505420165862], [-94.75124338921268, 29.599505420165862], [-94.7524127092656, 29.599505420165862], [-94.75358202931852, 29.599505420165862], [-94.75475134937145, 29.599505420165862], [-94.75592066942437, 29.599505420165862], [-94.7570899894773, 29.599505420165862], [-94.75825930953023, 29.599505420165862], [-94.75942862958316, 29.599505420165862], [-94.76059794963608, 29.599505420165862], [-94.761767269689, 29.599505420165862], [-94.76293658974193, 29.599505420165862], [-94.76410590979485, 29.599505420165862], [-94.76527522984777, 29.599505420165862], [-94.7664445499007, 29.599505420165862], [-94.76761386995362, 29.599505420165862], [-94.76878319000654, 29.599505420165862], [-94.76995251005947, 29.599505420165862], [-94.77112183011239, 29.599505420165862], [-94.77229115016532, 29.599505420165862], [-94.77346047021824, 29.599505420165862], [-94.77462979027116, 29.599505420165862], [-94.77579911032409, 29.599505420165862], [-94.77696843037701, 29.599505420165862], [-94.77813775042993, 29.599505420165862], [-94.77930707048286, 29.599505420165862], [-94.78047639053578, 29.599505420165862], [-94.7816457105887, 29.599505420165862], [-94.78281503064163, 29.599505420165862], [-94.78398435069455, 29.599505420165862], [-94.78515367074748, 29.599505420165862], [-94.7863229908004, 29.599505420165862], [-94.78749231085332, 29.599505420165862], [-94.78866163090625, 29.599505420165862], [-94.78983095095917, 29.599505420165862], [-94.7910002710121, 29.599505420165862], [-94.79216959106502, 29.599505420165862], [-94.79333891111794, 29.599505420165862], [-94.79450823117087, 29.599505420165862], [-94.79567755122379, 29.599505420165862], [-94.79684687127671, 29.599505420165862], [-94.79801619132964, 29.599505420165862], [-94.79918551138257, 29.599505420165862], [-94.8003548314355, 29.599505420165862], [-94.80152415148842, 29.599505420165862], [-94.80269347154135, 29.599505420165862], [-94.80386279159427, 29.599505420165862], [-94.8050321116472, 29.599505420165862], [-94.80620143170012, 29.599505420165862], [-94.80737075175304, 29.599505420165862], [-94.80854007180596, 29.599505420165862], [-94.80970939185889, 29.599505420165862], [-94.81087871191181, 29.599505420165862], [-94.81204803196474, 29.599505420165862], [-94.81321735201766, 29.599505420165862], [-94.81438667207058, 29.599505420165862], [-94.8155559921235, 29.599505420165862], [-94.81672531217643, 29.599505420165862], [-94.81789463222935, 29.599505420165862], [-94.81906395228228, 29.599505420165862], [-94.8202332723352, 29.599505420165862], [-94.82140259238813, 29.599505420165862], [-94.82257191244105, 29.599505420165862], [-94.82374123249397, 29.599505420165862], [-94.8249105525469, 29.599505420165862], [-94.82607987259982, 29.599505420165862], [-94.82724919265274, 29.599505420165862], [-94.82841851270567, 29.599505420165862], [-94.82958783275859, 29.599505420165862], [-94.83075715281151, 29.599505420165862], [-94.83192647286444, 29.599505420165862], [-94.83309579291736, 29.599505420165862], [-94.83426511297029, 29.599505420165862], [-94.83543443302321, 29.599505420165862], [-94.83660375307613, 29.599505420165862], [-94.83777307312906, 29.599505420165862], [-94.83894239318198, 29.599505420165862], [-94.84011171323492, 29.599505420165862], [-94.84128103328784, 29.599505420165862], [-94.84245035334077, 29.599505420165862], [-94.84361967339369, 29.599505420165862], [-94.84478899344661, 29.599505420165862], [-94.84595831349954, 29.599505420165862], [-94.84712763355246, 29.599505420165862], [-94.84829695360538, 29.599505420165862], [-94.84946627365831, 29.599505420165862], [-94.85063559371123, 29.599505420165862], [-94.85180491376416, 29.599505420165862], [-94.85297423381708, 29.599505420165862], [-94.85414355387, 29.599505420165862], [-94.85531287392293, 29.599505420165862], [-94.85648219397585, 29.599505420165862], [-94.85765151402877, 29.599505420165862], [-94.8588208340817, 29.599505420165862], [-94.85999015413462, 29.599505420165862], [-94.86115947418755, 29.599505420165862], [-94.86232879424047, 29.599505420165862], [-94.86349811429339, 29.599505420165862], [-94.86466743434632, 29.599505420165862], [-94.86583675439924, 29.599505420165862], [-94.86700607445216, 29.599505420165862], [-94.86817539450509, 29.599505420165862], [-94.86934471455801, 29.599505420165862], [-94.87051403461093, 29.599505420165862], [-94.87168335466386, 29.599505420165862], [-94.87285267471678, 29.599505420165862], [-94.8740219947697, 29.599505420165862], [-94.87519131482263, 29.599505420165862], [-94.87636063487555, 29.599505420165862], [-94.87752995492848, 29.599505420165862], [-94.8786992749814, 29.599505420165862], [-94.87986859503432, 29.599505420165862], [-94.88103791508726, 29.599505420165862], [-94.88220723514019, 29.599505420165862], [-94.88337655519311, 29.599505420165862], [-94.88454587524603, 29.599505420165862], [-94.88571519529896, 29.599505420165862], [-94.88688451535188, 29.599505420165862], [-94.8880538354048, 29.599505420165862], [-94.88922315545773, 29.599505420165862], [-94.89039247551065, 29.599505420165862], [-94.89156179556358, 29.599505420165862], [-94.8927311156165, 29.599505420165862], [-94.89390043566942, 29.599505420165862], [-94.89506975572235, 29.599505420165862], [-94.89623907577527, 29.599505420165862], [-94.8974083958282, 29.599505420165862], [-94.89857771588112, 29.599505420165862], [-94.89974703593404, 29.599505420165862], [-94.90091635598696, 29.599505420165862], [-94.90208567603989, 29.599505420165862], [-94.90325499609281, 29.599505420165862], [-94.90442431614574, 29.599505420165862], [-94.90559363619866, 29.599505420165862], [-94.90676295625158, 29.599505420165862], [-94.90676295625158, 29.59848528286551], [-94.90676295625158, 29.59746514556516], [-94.90676295625158, 29.59644500826481], [-94.90676295625158, 29.595424870964457], [-94.90676295625158, 29.594404733664106], [-94.90676295625158, 29.593384596363755], [-94.90676295625158, 29.592364459063404], [-94.90676295625158, 29.591344321763053], [-94.90676295625158, 29.590324184462702], [-94.90676295625158, 29.58930404716235], [-94.90676295625158, 29.588283909862], [-94.90676295625158, 29.58726377256165], [-94.90676295625158, 29.586243635261294], [-94.90676295625158, 29.585223497960943], [-94.90676295625158, 29.58420336066059], [-94.90676295625158, 29.58318322336024], [-94.90676295625158, 29.58216308605989], [-94.90676295625158, 29.58114294875954], [-94.90676295625158, 29.580122811459187], [-94.90676295625158, 29.579102674158836], [-94.90676295625158, 29.578082536858485], [-94.90676295625158, 29.577062399558134], [-94.90676295625158, 29.576042262257783], [-94.90676295625158, 29.57502212495743], [-94.9079322763045, 29.57502212495743], [-94.90910159635743, 29.57502212495743], [-94.90910159635743, 29.57400198765708], [-94.90910159635743, 29.57298185035673], [-94.90910159635743, 29.57196171305638], [-94.90910159635743, 29.570941575756027], [-94.90910159635743, 29.569921438455676], [-94.90910159635743, 29.568901301155325], [-94.90910159635743, 29.567881163854974], [-94.90910159635743, 29.566861026554623], [-94.90910159635743, 29.56584088925427], [-94.90910159635743, 29.56482075195392], [-94.90910159635743, 29.56380061465357], [-94.90910159635743, 29.56278047735322], [-94.90910159635743, 29.561760340052867], [-94.90910159635743, 29.560740202752516], [-94.90910159635743, 29.559720065452165], [-94.90910159635743, 29.558699928151814], [-94.90910159635743, 29.557679790851463], [-94.90910159635743, 29.55665965355111], [-94.90910159635743, 29.55563951625076], [-94.90910159635743, 29.55461937895041], [-94.90910159635743, 29.55359924165006], [-94.90910159635743, 29.552579104349707], [-94.90910159635743, 29.551558967049356], [-94.90910159635743, 29.550538829749005], [-94.90910159635743, 29.549518692448654], [-94.90910159635743, 29.548498555148303], [-94.90910159635743, 29.54747841784795], [-94.90910159635743, 29.546458280547597], [-94.90910159635743, 29.545438143247246], [-94.90910159635743, 29.544418005946895], [-94.90910159635743, 29.543397868646544], [-94.90910159635743, 29.542377731346193], [-94.90910159635743, 29.54135759404584], [-94.90910159635743, 29.54033745674549], [-94.90910159635743, 29.53931731944514], [-94.90910159635743, 29.538297182144788], [-94.90910159635743, 29.537277044844437], [-94.90910159635743, 29.536256907544086], [-94.90910159635743, 29.535236770243735], [-94.90910159635743, 29.534216632943384], [-94.90910159635743, 29.533196495643033], [-94.90910159635743, 29.53217635834268], [-94.90910159635743, 29.53115622104233], [-94.90910159635743, 29.53013608374198], [-94.90910159635743, 29.529115946441628], [-94.90910159635743, 29.528095809141277], [-94.90910159635743, 29.527075671840926], [-94.90910159635743, 29.526055534540575], [-94.90910159635743, 29.525035397240224], [-94.90910159635743, 29.524015259939873], [-94.90910159635743, 29.52299512263952], [-94.90910159635743, 29.52197498533917], [-94.90910159635743, 29.52095484803882], [-94.90910159635743, 29.519934710738468], [-94.90910159635743, 29.518914573438117], [-94.90910159635743, 29.517894436137766], [-94.90910159635743, 29.516874298837415], [-94.90910159635743, 29.515854161537064], [-94.90910159635743, 29.514834024236713], [-94.90910159635743, 29.51381388693636], [-94.90910159635743, 29.51279374963601], [-94.90910159635743, 29.51177361233566], [-94.90910159635743, 29.510753475035308], [-94.90910159635743, 29.509733337734957], [-94.90910159635743, 29.508713200434606], [-94.90910159635743, 29.507693063134255], [-94.90910159635743, 29.506672925833904], [-94.90910159635743, 29.50565278853355], [-94.90910159635743, 29.504632651233198], [-94.90910159635743, 29.503612513932847], [-94.90910159635743, 29.502592376632496], [-94.90910159635743, 29.501572239332145], [-94.90910159635743, 29.500552102031794], [-94.90910159635743, 29.499531964731442], [-94.90910159635743, 29.49851182743109], [-94.91027091641035, 29.49851182743109], [-94.91027091641035, 29.49749169013074], [-94.91027091641035, 29.49647155283039], [-94.91144023646328, 29.49647155283039], [-94.91144023646328, 29.495451415530038], [-94.91144023646328, 29.494431278229687], [-94.91144023646328, 29.493411140929336], [-94.91144023646328, 29.492391003628985], [-94.91144023646328, 29.491370866328634], [-94.91144023646328, 29.490350729028282], [-94.91144023646328, 29.48933059172793], [-94.91144023646328, 29.48831045442758], [-94.91144023646328, 29.48729031712723], [-94.91144023646328, 29.486270179826878], [-94.91144023646328, 29.485250042526527], [-94.91144023646328, 29.484229905226176], [-94.91144023646328, 29.483209767925825], [-94.91144023646328, 29.482189630625474], [-94.91144023646328, 29.481169493325122], [-94.91144023646328, 29.48014935602477], [-94.91144023646328, 29.47912921872442], [-94.91144023646328, 29.47810908142407], [-94.91144023646328, 29.477088944123718], [-94.91144023646328, 29.476068806823367], [-94.91144023646328, 29.475048669523016], [-94.91144023646328, 29.474028532222665], [-94.91144023646328, 29.473008394922314], [-94.91144023646328, 29.471988257621963], [-94.91144023646328, 29.47096812032161], [-94.91144023646328, 29.46994798302126], [-94.91144023646328, 29.46892784572091], [-94.91144023646328, 29.467907708420558], [-94.91144023646328, 29.466887571120207], [-94.91144023646328, 29.465867433819852], [-94.91144023646328, 29.4648472965195], [-94.91144023646328, 29.46382715921915], [-94.91144023646328, 29.4628070219188], [-94.91144023646328, 29.461786884618448], [-94.91144023646328, 29.460766747318097], [-94.91144023646328, 29.459746610017746], [-94.91144023646328, 29.458726472717395], [-94.91144023646328, 29.457706335417043]]
        var origin = coordinates[0]
        var destination = coordinates.at(-1)
        var origin2 = coordinates2[0]
        var destination2 = coordinates2.at(-1)


        // A simple line from origin to destination.
        var route = {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "geometry": {
                    "type": "LineString",
                    "coordinates": coordinates
                }
            }]
        }

        // A single point that animates along the route.
        // Coordinates are initially set to origin.
        var point = {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": origin
                }
            }]
        }

        var route2 = {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "geometry": {
                    "type": "LineString",
                    "coordinates": coordinates2
                }
            }]
        }
        // A single point that animates along the route.
        // Coordinates are initially set to origin.
        var point2 = {
            "type": "FeatureCollection",
            "features": [{
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": origin2
                }
            }]
        }

        // Calculate the distance in kilometers between route start/end point
        var lineDistance = turf.lineDistance(route.features[0], 'kilometers');
        var lineDistance2 = turf.lineDistance(route2.features[0], 'kilometers');


        // Add a source and layer displaying a point which will be animated in a circle.
        map.addSource('route', {
            "type": "geojson",
            "data": route
        });

        map.addSource('point', {
            "type": "geojson",
            "data": point
        });

        map.addSource('route2', {
            "type": "geojson",
            "data": route2
        });

        map.addSource('point2', {
            "type": "geojson",
            "data": point2
        });

        map.addLayer({
            "id": "route",
            "source": "route",
            "type": "line",
            "paint": {
                "line-width": 2,
                "line-color": "#007cbf",
                "line-dasharray": [2, 1]
            }
        });

        map.addLayer({
            "id": "point",
            "source": "point",
            "type": "symbol",
            "layout": {
                "icon-image": "shipr",
                "icon-rotate": -360
            }
        });

        map.addLayer({
            "id": "route2",
            "source": "route2",
            "type": "line",
            "paint": {
                "line-width": 2,
                "line-color": "#003cbf",
                "line-dasharray": [2, 1]
            }
        });

        map.addLayer({
            "id": "point2",
            "source": "point2",
            "type": "symbol",
            "layout": {
                "icon-image": "shipr",
                "icon-rotate": -360
            }
        });


        const normalSpeed = 0.3
        const stopSpeed = 0


        var counter = 0;
        var counter2 = 0;
        speed = normalSpeed
        function animate() {
            counter = counter + speed;

            // Update point geometry to a new position based on the animation
            // And the distance the point has travelled along the route.
            var updatedPoint = turf.along(route.features[0], counter / 1000 * lineDistance, 'kilometers');
            point.features = [updatedPoint];

            // Update the source with this new data.
            map.getSource('point').setData(point);

            // Request the next frame of the animation so long as destination.
            // has not been reached.
                requestAnimationFrame(animate);

        }

        function animate2() {
            counter2 = counter2 + speed;

            // Update point geometry to a new position based on the animation
            // And the distance the point has travelled along the route.
            var updatedPoint = turf.along(route2.features[0], counter2 / 1000 * lineDistance2, 'kilometers');
            point2.features = [updatedPoint];

            // Update the source with this new data.
            map.getSource('point2').setData(point2);

            // Request the next frame of the animation so long as destination.
            // has not been reached.
         
                requestAnimationFrame(animate2);
            
        }

        // Start the animation.
        animate()
        animate2()

        function pixelToCoord() {

        }
        var counter3 = 0;
        $("#pause").click(function () {


            speed = stopSpeed
        })

        $("#start").click(function () {


            speed = normalSpeed
        })

        $("#reset").click(function () {


            counter = 0
            counter2 = 0
            counter3 = 0
            speed = stopSpeed

        })



        $("#addShip").click(function () {


            let start = $("#coord1").text()
            start = start.substring(0, start.length - 1)
            console.log(start.split(","))

            let destination = $("#coord2").text()
            destination = destination.substring(0, destination.length - 1)

            const shipName = $("#shipName").val()
            console.log(shipName)

            $.post("./createpath", { start: start, destination: destination }, function (data) {
                const json = JSON.parse(data)
                const path = json.path

                console.log(path)


                var route3 = {
                    "type": "FeatureCollection",
                    "features": [{
                        "type": "Feature",
                        "geometry": {
                            "type": "LineString",
                            "coordinates": path
                        }
                    }]
                }

                var point3 = {
                    "type": "FeatureCollection",
                    "features": [{
                        "type": "Feature",
                        "geometry": {
                            "type": "Point",
                            "coordinates": path[0]
                        }
                    }]
                }

                map.addSource(shipName + "route", {
                    "type": "geojson",
                    "data": route3
                });

                map.addSource(shipName + "point", {
                    "type": "geojson",
                    "data": point3
                });

                map.addLayer({
                    "id": shipName + "route",
                    "source": shipName + "route",
                    "type": "line",
                    "paint": {
                        "line-width": 2,
                        "line-color": "#007cbf",
                        "line-dasharray": [2, 1]
                    }
                });

                map.addLayer({
                    "id": shipName + "point",
                    "source": shipName + "point",
                    "type": "symbol",
                    "layout": {
                        "icon-image": "shipr",
                        "icon-rotate": -360
                    }
                });


                var lineDistance3 = turf.lineDistance(route3.features[0], 'kilometers');
               

                function animate3() {
                    counter3 = counter3 + speed;

                    // Update point geometry to a new position based on the animation
                    // And the distance the point has travelled along the route.
                    var updatedPoint = turf.along(route3.features[0], counter3 / 1000 * lineDistance3, 'kilometers');
                    point3.features = [updatedPoint];

                    // Update the source with this new data.
                    map.getSource(shipName + "point").setData(point3);

                    // Request the next frame of the animation so long as destination.
                    // has not been reached.

                        requestAnimationFrame(animate3);

                }

                animate3()


            });

        });


    });
</script>


<script>
    $(function () {




    });
</script>
<script type='text/javascript' src="{% static 'images/deneme.js' %}"></script>